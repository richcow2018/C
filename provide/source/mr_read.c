/*----------------------------------------------------------------------------------------------*/
/* ¡ãÂÐ¾Ý¶ÈÌ³Ì¾¡ä                    ¸Î¾ã´ÉÍý¶ÈÌ³      ¡¡¡¡         							*/
/* ¡ãÂÐ¾Ý¶ÈÌ³£É£Ä¡ä                  £Ò£Ã£Ö                         							*/
/* ¡ã¥µ¡¼¥Ó¥¹¹àÌÜÌ¾¡ä                ¥Æ¡¼¥Ö¥ë¥ê¥«¥Ð¥ê          ¡¡   							*/
/* ¡ã¥µ¡¼¥Ó¥¹¹àÌÜ£É£Ä¡ä              trcv	                   									*/
/* ¡ã¥â¥¸¥å¡¼¥ëÌ¾¡ä                  £í£ò¡²read													*/
/* ¡ã¥â¥¸¥å¡¼¥ë£É£Ä¡ä                £Ø£Ø£Ø£Ø£Ø£Ø£Ø£Ø               							*/
/* ¡ã¥â¥¸¥å¡¼¥ëÄÌÈÖ¡ä                                               							*/
/*----------------------------------------------------------------------------------------------*/
/* ¡ãÅ¬ÍÑµ¡¼ï¡ä                      £Á£Ã£Å                         							*/
/* ¡ãÅ¬ÍÑ£Ï£Ó¡ä                      £Ì£É£Î£Õ£Ø                     							*/
/* ¡ã³«È¯´Ä¶­¡ä                      £Ì£É£Î£Õ£Ø                     							*/
/* ¡ãµ­½Ò¸À¸ì¡ä                      £Ã¸À¸ì                         							*/
/* ¡ã¥â¥¸¥å¡¼¥ë·ÁÂÖ¡ä                ¥³¥Þ¥ó¥É                       							*/
/* ¡ãµ¡Ç½¶èÊ¬¡ä                                                     							*/
/* ¡ãÂÐ¾Ý¥Ç¡¼¥¿¡ä                                                   							*/
/* ¡ã¹©Äø¡¦³¬ÁØ¶èÊ¬¡ä                                               							*/
/*----------------------------------------------------------------------------------------------*/
/* ¡ã³«È¯¥·¥¹¥Æ¥àÌ¾¡ä                £Á£Ã£Å¡Ý£Ó£Í£Ð¥·¥¹¥Æ¥à         							*/
/* ¡ã³«È¯¥·¥¹¥Æ¥àÈÖ¹æ¡ä              £Ø£Ø£Ø£Ø£Ø£Ø£Ø£Ø£Ø£Ø£Ø£Ø       							*/
/*----------------------------------------------------------------------------------------------*/
/* ¡ã³«È¯Ã´Åö¼ÔÌ¾¡ä                  £Ó£õ£ð£ð£ì£ù                   							*/
/* ¡ãÅÅÏÃÈÖ¹æ¡ä                                         							*/
/*----------------------------------------------------------------------------------------------*/
/* ¡ãÀß·×¼ÔÌ¾¡ä¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡¡£Ó£õ£ð£ð£ì£ù                   							*/
/* ¡ãÀß·×Ç¯·îÆü¡ä                    £²£°£°£³Ç¯£°£´·î£±£°Æü	         							*/
/* ¡ãÀß·×½¤Àµ¼ÔÌ¾¡ä                  ¼ë                             							*/
/* ¡ãÀß·×½¤ÀµÇ¯·îÆüµÚ¤Ó½¤Àµ£É£Ä¡ä                                  							    */
/*----------------------------------------------------------------------------------------------*/
/* ¡ã¥½¡¼¥¹ºîÀ®¼ÔÌ¾¡ä                £Ó£õ£ð£ð£ì£ù                   							*/
/* ¡ã¥½¡¼¥¹ºîÀ®Ç¯·îÆü¡ä              £²£°£°£³Ç¯£°£´·î£±£°Æü	         							*/
/* ¡ã¥½¡¼¥¹½¤Àµ¼ÔÌ¾¡ä                                               							*/
/* ¡ã¥½¡¼¥¹½¤ÀµÇ¯·îÆüµÚ¤Ó½¤Àµ£É£Ä¡ä                                 							*/
/*----------------------------------------------------------------------------------------------*/
/* ¡ã¸«ÀÑ¥¹¥Æ¥Ã¥×¿ô¡ä                ¥¹¥Æ¥Ã¥×                       							*/
/*---------------------------------------------------------------------------------------------	*/
/* ¡ãµ¡Ç½³µÍ×¡ä                                                     							*/
/*                                                                  							*/
/*     °ú·Ñ¤®¾ðÊó¥Õ¥¡¥¤¥ë¤òÆÉ¹þ¤ß			   													*/
/*                                                                  							*/
/*----------------------------------------------------------------------------------------------*/
/* ¡ã¸Æ½Ð·Á¼°¡ä                                                     							*/
/*		long mr_writ(int iFd, char *pcDatabuf, long buflen)										*/
/*                                                                  							*/
/* ¡ã²¾°ú¿ô¡ä                                                       							*/
/*		int	 	iFd				¥Õ¥¡¥¤¥ë ¥Ç¥£¥¹¥¯¥ê¥×¥¿  										*/
/*		char  	*pcDatabuf		¥Õ¥¡¥¤¥ë¤Ë½ñ¤­¹þ¤à¥Ç¡¼¥¿										*/
/*		long 	buflen 			¥Ç¡¼¥¿Ä¹														*/
/*              	                                                							*/
/* ¡ãÊÖµÑÃÍ¡ä                                                       							*/
/*		SYSERROR(-1)	°Û¾ï																	*/
/*		MRNORMAL(0)		Àµ¾ï																	*/
/*		MRNORMX(1)		EOF																		*/
/*----------------------------------------------------------------------------------------------*/
/* ¡ãÀ©¸Â»ö¹à¡ä         ¤Ê¤·                                        							*/
/*                                                                  							*/
/* ¡ã»ÈÍÑ³°Éô¥â¥¸¥å¡¼¥ë£É£Ä¡ä                                      	                            */
/* ¡ã¸Æ½Ð¥â¥¸¥å¡¼¥ë£É£Ä¡ä                                           							*/
/*                                                                  							*/
/************************************************************************************************/

/************************************************************************************************/
/*								¶¦ÄÌ¥Ø¥Ã¥À¡¦¥Õ¥¡¥¤¥ë                							*/
/*																								*/
/************************************************************************************************/
#include <stdio.h>
#include <stdlib.h>
#include <fcntl.h>
#include <string.h>
#include <sys/types.h> 
#include <unistd.h> 
#include <errno.h>
#include <sys/stat.h> 


/************************************************************************************************/
/*								ÍøÍÑ¼ÔºîÀ®¥Ø¥Ã¥À¡¦¥Õ¥¡¥¤¥ë             							*/
/*																								*/
/************************************************************************************************/
#include    "mr.h"
#include	"mrmsg.h"
#include	"mcdebug.h"



/************************************************************************************************/
/*																								*/
/*	¡ã´Ø¿ôÌ¾¡ä	long mr_read(int iFd, char* pcDatabuf, long buflen)								*/
/*																								*/
/*	¡ãµ¡Ç½³µÍ×¡ä  °ú·Ñ¤®¾ðÊó¥Õ¥¡¥¤¥ë¤òÆÉ¹þ¤ß													*/
/*  																							*/
/*	¥ê¥¿¡¼¥ó:																					*/
/*			¼ºÇÔ(SYSERROR)																		*/	
/*			EOF (MRNORMX)																		*/
/*			À®¸ù(MRNORMAL)																		*/
/************************************************************************************************/
long mr_read(int iFd, char *pcDatabuf, long buflen)
{
	
	long lRet = 0;											/* ÊÖµÑÃÍ							*/
	
	PRINTF("(1) mr_read - iFd = %ld\n", iFd);

	while(buflen != lRet)
	{
		
		lRet = read(iFd, pcDatabuf, buflen);				/* ¥Õ¥¡¥¤¥ë¤«¤é¥Ç¡¼¥¿ÆÉ¤ß½Ð¤¹		*/
		
		PRINTF("(2) mr_read - lRet = %ld\n", lRet);
		
		if(lRet == SYSERROR) 
		{													/* °Û¾ï¤Î»þ							*/
			
			if(errno != EINTR)								/* EINTR°Ê³°¤Ç¤¢¤ì¤Ð				*/
			{
				lRet = SYSERROR;
			
				goto exit_from_read;						/* °Û¾ï½ªÎ»							*/
			}
		}
		else if(lRet == MRNORMAL)							/* EOF¤Î¾ì¹ç¤Ï						*/
		{
			lRet = MRNORMX;									/* EOF¤òÊÖµÑ						*/
			
			goto exit_from_read;							/* ½ªÎ»½èÍý							*/
		}
			
	}

	lRet = MRNORMAL;


exit_from_read:

	PRINTF("(3) mr_read - EXIT lRet = %ld\n", lRet);

	return(lRet);											/* ½ªÎ»½èÍý							*/
}

   
